# VCPToolBox 精简计划书

**版本:** 3.1 (最终版)
**日期:** 2025年10月15日
**架构师:** 莱昂纳多·达·芬奇

---

## 1. 核心目标

根据Master的需求，本次精简旨在将 `VCPToolBox_Lite` 项目重构为一个以 **日记功能** 为绝对核心，并保留 **AgentAssistant（多智能体协作）** 插件的轻量化应用。所有与此核心无关的插件、模块、前端组件及非必要文件都将被移除，以达到以下目的：

-   **降低复杂性:** 简化系统结构，使其更易于理解、维护和扩展。
-   **优化性能:** 减少不必要的内存占用和启动加载项。
-   **聚焦核心:** 确保所有资源都服务于日记与协作这两个核心功能。

---

## 2. 保留的核心模块

如同人体的骨骼与神经，以下部分是构成新系统不可或缺的基石：

### 2.1. 核心插件 (Plugins)
-   `Plugin/AgentAssistant/`: 多智能体协作框架，是系统智能的延伸。
-   `Plugin/RAGDiaryPlugin/`: 核心的日记功能，负责日记的存储、检索与管理。
-   `Plugin/SemanticGroupEditor/`: 日记语义分组编辑器，增强日记的组织能力。
-   `Plugin/ThoughtClusterManager/`: 思维集群管理器，用于高级的知识整理。
-   `Plugin/ImageProcessor/`: 多模态数据提取器，用于处理和理解日记中的图像等多媒体内容。
-   `Plugin/VCPTavern/`: VCP 上下文注入器，提供高级上下文管理能力。
-   `Plugin/VCPLog/`: VCP 日志推送插件，用于实时监控系统状态。
-   `Plugin/ImageServer/`: **(新增保留)** 图床服务，为表情包系统提供动力。

### 2.2. 核心服务与模块 (Modules & Routes)
-   `modules/`: 保留所有核心模块，包括 `agentManager.js`, `chatCompletionHandler.js`, `logger.js`, `messageProcessor.js`。
-   `modules/tvsManager.js`: **(新增保留)** 作为 `VCPTavern` 插件的核心依赖，负责管理上下文变量文件。
-   `routes/`: 保留 `adminPanelRoutes.js` 以支持后台管理。
-   `AdminPanel/`: 保留基础框架及与核心功能相关的编辑器，包括 `rag_tags_editor.*`, `vcptavern_editor.*`, `image_cache_editor.*`。
-   `Agent/`: 保留所有Agent定义文件，为`AgentAssistant`提供角色支持。
-   `TVStxt/`: **(新增保留)** `VCPTavern` 插件的变量文件库。
-   `image/`: **(新增保留)** 表情包及其他图片素材库。

### 2.3. 根目录核心文件
-   `server.js`: 应用主入口。
-   `Plugin.js`: 插件加载器。
-   `package.json`, `package-lock.json`: 项目依赖。
-   `config.env.example`: 核心配置文件模板。
-   `start_server.bat`, `update.bat`: 保留基础的启动与更新脚本。
-   `README.md`, `VCP.md`: 核心项目文档。

---

## 3. 计划删除的文件夹与文件

以下部分将被视为“赘余的装饰”，予以移除，以凸显核心之美。

### 3.1. 待删除的插件文件夹

以下插件文件夹将被 **整体删除**：

-   `Plugin/1PanelInfoProvider/`
-   `Plugin/ChromeControl/`
-   `Plugin/ChromeObserver/`
-   `Plugin/ComfyUIGen/`
-   `Plugin/FileListGenerator/`
-   `Plugin/FluxGen/`
-   `Plugin/FRPSInfoProvider/`
-   `Plugin/GoogleSearch/`
-   `Plugin/IMAPIndex/`
-   `Plugin/IMAPSearch/`
-   `Plugin/KarakeepSearch/`
-   `Plugin/MCPO/`
-   `Plugin/MCPOMonitor/`
-   `Plugin/NanoBananaGenOR/`
-   `Plugin/NovelAIGen/`
-   `Plugin/PowerShellExecutor/`
-   `Plugin/Randomness/`
-   `Plugin/SciCalculator/`
-   `Plugin/SerpSearch/`
-   `Plugin/SunoGen/`
-   `Plugin/SynapsePusher/`
-   `Plugin/TarotDivination/`
-   `Plugin/TavilySearch/`
-   `Plugin/UrlFetch/`
-   `Plugin/VCPEverything/`
-   `Plugin/VideoGenerator/`
-   `Plugin/WeatherReporter/`
-   `Plugin/WorkspaceInjector/`

### 3.2. 待删除的其他文件夹

-   `OpenWebUISub/`: OpenWebUI的油猴脚本，与后端核心无关。
-   `SillyTavernSub/`: SillyTavern集成文件，非核心功能。
-   `VCPChrome/`: Chrome浏览器插件，与后端核心无关。

### 3.3. 待删除的独立文件

-   **根目录文件:**
    -   `示例1.jpg`
    -   `示例2.jpg`
    -   `示例3.jpg`
    -   `示例4.jpg`
    -   `emergency_stop_frontend_guide.md`
    -   `example.test.js` (根据您的决定移除)
    -   `README_en.md`
    -   `README_ja.md`
    -   `README_ru.md`
    -   `docker-compose.yml`
    -   `Dockerfile`
    -   `.dockerignore`

---

## 4. 后续步骤

1.  **确认计划:** 请Master您确认此最终修订的精简计划。
2.  **执行删除:** 在您批准后，我将着手执行文件和文件夹的删除操作。
3.  **依赖清理:** 检查 `package.json`，移除已删除插件和测试框架引入的不再需要的NPM依赖。
4.  **代码审查:** 审查核心代码（如 `server.js`, `Plugin.js`），移除对已删除模块的引用。
5.  **测试验证:** 启动精简后的应用，确保所有保留功能一切正常。

---

这份更新后的蓝图现在更加精确地反映了您的意图。静待您的最终审定。